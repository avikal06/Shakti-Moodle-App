{"version":3,"sources":["./src/addons/messages/pages/settings/settings.html","./src/addons/messages/messages-settings-lazy.module.ts","./src/addons/messages/pages/settings/settings.ts"],"names":[],"mappings":"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","file":"messages-settings-lazy-module.js","sourcesContent":["export default \"<ion-header>\\r\\n    <ion-toolbar>\\r\\n        <ion-buttons slot=\\\"start\\\">\\r\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\r\\n        </ion-buttons>\\r\\n        <ion-title>\\r\\n            <h1>{{ 'addon.messages.messages' | translate }}</h1>\\r\\n        </ion-title>\\r\\n    </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!preferencesLoaded\\\" (ionRefresh)=\\\"refreshPreferences($event.target)\\\">\\r\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\r\\n    </ion-refresher>\\r\\n    <core-loading [hideUntil]=\\\"preferencesLoaded\\\">\\r\\n        <!-- General settings. -->\\r\\n        <ion-card>\\r\\n            <ion-list>\\r\\n                <ion-item-divider class=\\\"ion-text-wrap\\\">\\r\\n                    <ion-label>\\r\\n                        <h2>{{ 'core.settings.general' | translate }}</h2>\\r\\n                    </ion-label>\\r\\n                </ion-item-divider>\\r\\n                <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                    <ion-label>\\r\\n                        <p>{{ 'addon.messages.useentertosend' | translate }}</p>\\r\\n                    </ion-label>\\r\\n                    <ion-toggle [(ngModel)]=\\\"sendOnEnter\\\" (ngModelChange)=\\\"sendOnEnterChanged()\\\" slot=\\\"end\\\"></ion-toggle>\\r\\n                </ion-item>\\r\\n            </ion-list>\\r\\n        </ion-card>\\r\\n\\r\\n        <!-- Contactable privacy. -->\\r\\n        <ion-card>\\r\\n            <ion-item *ngIf=\\\"!advancedContactable\\\">\\r\\n                <ion-label class=\\\"ion-text-wrap\\\">\\r\\n                    <p>{{ 'addon.messages.blocknoncontacts' | translate }}</p>\\r\\n                </ion-label>\\r\\n                <ion-toggle [(ngModel)]=\\\"contactablePrivacy\\\" (ngModelChange)=\\\"saveContactablePrivacy(contactablePrivacy)\\\" slot=\\\"end\\\">\\r\\n                </ion-toggle>\\r\\n            </ion-item>\\r\\n\\r\\n            <ion-list *ngIf=\\\"advancedContactable\\\">\\r\\n                <ion-radio-group [(ngModel)]=\\\"contactablePrivacy\\\" (ionChange)=\\\"saveContactablePrivacy(contactablePrivacy)\\\">\\r\\n                    <ion-item-divider>\\r\\n                        <ion-label>\\r\\n                            <h2>{{ 'addon.messages.contactableprivacy' | translate }}</h2>\\r\\n                        </ion-label>\\r\\n                    </ion-item-divider>\\r\\n                    <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-label>\\r\\n                            <p>{{ 'addon.messages.contactableprivacy_onlycontacts' | translate }}</p>\\r\\n                        </ion-label>\\r\\n                        <ion-radio slot=\\\"start\\\" [value]=\\\"onlyContactsValue\\\"></ion-radio>\\r\\n                    </ion-item>\\r\\n                    <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-label>\\r\\n                            <p>{{ 'addon.messages.contactableprivacy_coursemember' | translate }}</p>\\r\\n                        </ion-label>\\r\\n                        <ion-radio slot=\\\"start\\\" [value]=\\\"courseMemberValue\\\"></ion-radio>\\r\\n                    </ion-item>\\r\\n                    <ion-item *ngIf=\\\"allowSiteMessaging\\\" class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-label>\\r\\n                            <p>{{ 'addon.messages.contactableprivacy_site' | translate }}</p>\\r\\n                        </ion-label>\\r\\n                        <ion-radio slot=\\\"start\\\" [value]=\\\"siteValue\\\"></ion-radio>\\r\\n                    </ion-item>\\r\\n                </ion-radio-group>\\r\\n            </ion-list>\\r\\n        </ion-card>\\r\\n\\r\\n        <!-- Notifications. -->\\r\\n        <ng-container *ngIf=\\\"preferences\\\">\\r\\n            <ng-container *ngIf=\\\"!groupMessagingEnabled\\\">\\r\\n                <ng-container *ngTemplateOutlet=\\\"legacySettings; context: {preferences: preferences}\\\"></ng-container>\\r\\n            </ng-container>\\r\\n            <ng-container *ngIf=\\\"groupMessagingEnabled\\\">\\r\\n                <ng-container *ngTemplateOutlet=\\\"settings; context: {preferences: preferences}\\\"></ng-container>\\r\\n            </ng-container>\\r\\n        </ng-container>\\r\\n    </core-loading>\\r\\n</ion-content>\\r\\n\\r\\n<!-- Only 3.5 version -->\\r\\n<ng-template #legacySettings let-preferences=\\\"preferences\\\">\\r\\n    <ng-container *ngFor=\\\"let component of preferences.components\\\">\\r\\n        <ion-card *ngFor=\\\"let notification of component.notifications\\\">\\r\\n            <ion-card-header class=\\\"ion-no-padding\\\">\\r\\n                <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                    <ion-label>\\r\\n                        <h2>{{ notification.displayname }}</h2>\\r\\n                    </ion-label>\\r\\n                </ion-item>\\r\\n            </ion-card-header>\\r\\n            <ion-card-content class=\\\"ion-no-padding\\\">\\r\\n                <ng-container *ngFor=\\\"let processor of notification.processors\\\">\\r\\n                    <ion-item-divider class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-label>\\r\\n                            <p class=\\\"item-heading\\\">{{ processor.displayname }}</p>\\r\\n                        </ion-label>\\r\\n                    </ion-item-divider>\\r\\n                    <!-- If notifications not disabled, show toggles.\\r\\n                        If notifications are disabled, show \\\"Disabled\\\" instead of toggle. -->\\r\\n                    <ion-item *ngFor=\\\"let state of ['loggedin', 'loggedoff']\\\" class=\\\"ion-text-wrap\\\">\\r\\n                        <ion-label>\\r\\n                            <p>{{ 'core.settings.' + state | translate }}</p>\\r\\n                        </ion-label>\\r\\n                        <ng-container *ngIf=\\\"!preferences.disableall\\\">\\r\\n                            <!-- If notifications enabled, show toggle. -->\\r\\n                            <core-button-with-spinner *ngIf=\\\"!processor.locked\\\" [loading]=\\\"notification['updating'+state]\\\" slot=\\\"end\\\">\\r\\n                                <ion-toggle [(ngModel)]=\\\"processor[state].checked\\\"\\r\\n                                    (ngModelChange)=\\\"changePreferenceLegacy(notification, processor, state)\\\">\\r\\n                                </ion-toggle>\\r\\n                            </core-button-with-spinner>\\r\\n                            <span *ngIf=\\\"processor.locked && processor[state].checked\\\" class=\\\"text-gray\\\" slot=\\\"end\\\">\\r\\n                                {{'core.settings.forced' | translate }}\\r\\n                            </span>\\r\\n                            <span *ngIf=\\\"processor.locked && !processor[state].checked\\\" class=\\\"text-gray\\\" slot=\\\"end\\\">\\r\\n                                {{'core.settings.disallowed' | translate }}\\r\\n                            </span>\\r\\n                        </ng-container>\\r\\n                        <span *ngIf=\\\"preferences.disableall\\\">{{ 'core.settings.disabled' | translate }}</span>\\r\\n                    </ion-item>\\r\\n                </ng-container>\\r\\n            </ion-card-content>\\r\\n        </ion-card>\\r\\n    </ng-container>\\r\\n</ng-template>\\r\\n\\r\\n\\r\\n<ng-template #settings let-preferences=\\\"preferences\\\">\\r\\n    <ng-container *ngFor=\\\"let component of preferences.components\\\">\\r\\n        <ion-card *ngFor=\\\"let notification of component.notifications\\\">\\r\\n            <ion-item-divider class=\\\"ion-text-wrap\\\">\\r\\n                <ion-label>\\r\\n                    <h2>{{ 'addon.notifications.notificationpreferences' | translate }}</h2>\\r\\n                </ion-label>\\r\\n            </ion-item-divider>\\r\\n            <ng-container *ngFor=\\\"let processor of notification.processors\\\">\\r\\n                <!-- If group messaging is enabled, display a simplified view. -->\\r\\n                <ion-item class=\\\"ion-text-wrap\\\">\\r\\n                    <ion-label>\\r\\n                        <p>{{ processor.displayname }}</p>\\r\\n                    </ion-label>\\r\\n                    <ng-container *ngIf=\\\"!preferences.disableall\\\">\\r\\n                        <!-- If notifications enabled, show toggle. -->\\r\\n                        <core-button-with-spinner *ngIf=\\\"!processor.locked\\\" [loading]=\\\"notification.updating\\\" slot=\\\"end\\\">\\r\\n                            <ion-toggle [(ngModel)]=\\\"processor.enabled\\\" (ngModelChange)=\\\"changePreference(notification, processor)\\\">\\r\\n                            </ion-toggle>\\r\\n                        </core-button-with-spinner>\\r\\n                        <span class=\\\"text-gray\\\" *ngIf=\\\"processor.locked\\\" slot=\\\"end\\\">\\r\\n                            {{ processor.lockedmessage }}\\r\\n                        </span>\\r\\n                    </ng-container>\\r\\n                    <span *ngIf=\\\"preferences.disableall\\\" class=\\\"text-gray\\\" slot=\\\"end\\\">{{ 'core.settings.disabled' | translate }}</span>\\r\\n                </ion-item>\\r\\n            </ng-container>\\r\\n        </ion-card>\\r\\n    </ng-container>\\r\\n</ng-template>\\r\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { CoreSharedModule } from '@/core/shared.module';\nimport { AddonMessagesSettingsPage } from '@addons/messages/pages/settings/settings';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: AddonMessagesSettingsPage,\n    },\n];\n\n@NgModule({\n    imports: [\n        RouterModule.forChild(routes),\n        CoreSharedModule,\n    ],\n    declarations: [\n        AddonMessagesSettingsPage,\n    ],\n    exports: [RouterModule],\n})\nexport class AddonMessagesSettingsLazyModule {}\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport {\n    AddonMessagesProvider, AddonMessagesMessagePreferences,\n    AddonMessagesMessagePreferencesNotification,\n    AddonMessagesMessagePreferencesNotificationProcessor,\n    AddonMessages,\n} from '../../services/messages';\nimport { CoreUser } from '@features/user/services/user';\nimport { CoreConfig } from '@services/config';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreConstants } from '@/core/constants';\nimport { IonRefresher } from '@ionic/angular';\nimport { AddonNotificationsPreferencesNotificationProcessorState } from '@addons/notifications/services/notifications';\nimport { CorePlatform } from '@services/platform';\n\n/**\n * Page that displays the messages settings page.\n */\n@Component({\n    selector: 'page-addon-messages-settings',\n    templateUrl: 'settings.html',\n})\nexport class AddonMessagesSettingsPage implements OnInit, OnDestroy {\n\n    protected updateTimeout?: number;\n\n    preferences?: AddonMessagesMessagePreferences;\n    preferencesLoaded = false;\n    contactablePrivacy?: number | boolean;\n    advancedContactable = false; // Whether the site supports \"advanced\" contactable privacy.\n    allowSiteMessaging = false;\n    onlyContactsValue = AddonMessagesProvider.MESSAGE_PRIVACY_ONLYCONTACTS;\n    courseMemberValue = AddonMessagesProvider.MESSAGE_PRIVACY_COURSEMEMBER;\n    siteValue = AddonMessagesProvider.MESSAGE_PRIVACY_SITE;\n    groupMessagingEnabled = false;\n    sendOnEnter = false;\n\n    protected loggedInOffLegacyMode = false;\n    protected previousContactableValue?: number | boolean;\n\n    constructor() {\n\n        const currentSite = CoreSites.getRequiredCurrentSite();\n        this.advancedContactable = !!currentSite.isVersionGreaterEqualThan('3.6');\n        this.allowSiteMessaging = !!currentSite.canUseAdvancedFeature('messagingallusers');\n        this.groupMessagingEnabled = AddonMessages.isGroupMessagingEnabled();\n        this.loggedInOffLegacyMode = !currentSite.isVersionGreaterEqualThan('4.0');\n\n        this.asyncInit();\n    }\n\n    protected async asyncInit(): Promise<void> {\n        this.sendOnEnter = !!(await CoreConfig.get(CoreConstants.SETTINGS_SEND_ON_ENTER, !CorePlatform.isMobile()));\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnInit(): void {\n        this.fetchPreferences();\n    }\n\n    /**\n     * Fetches preference data.\n     *\n     * @returns Promise resolved when done.\n     */\n    protected async fetchPreferences(): Promise<void> {\n        try {\n            const preferences = await AddonMessages.getMessagePreferences();\n            if (this.groupMessagingEnabled) {\n                // Simplify the preferences.\n                for (const component of preferences.components) {\n                    // Only display get the notification preferences.\n                    component.notifications = component.notifications.filter((notification) =>\n                        notification.preferencekey == AddonMessagesProvider.NOTIFICATION_PREFERENCES_KEY);\n\n                    if (this.loggedInOffLegacyMode) {\n                        // Load enabled from loggedin / loggedoff values.\n                        component.notifications.forEach((notification) => {\n                            notification.processors.forEach(\n                                (processor) => {\n                                    processor.enabled = processor.loggedin.checked || processor.loggedoff.checked;\n                                },\n                            );\n                        });\n                    }\n                }\n            }\n\n            this.preferences = preferences;\n            this.contactablePrivacy = preferences.blocknoncontacts;\n            this.previousContactableValue = this.contactablePrivacy;\n        } catch (error) {\n            CoreDomUtils.showErrorModal(error);\n        } finally {\n            this.preferencesLoaded = true;\n        }\n    }\n\n    /**\n     * Update preferences. The purpose is to store the updated data, it won't be reflected in the view.\n     */\n    protected updatePreferences(): void {\n        AddonMessages.invalidateMessagePreferences().finally(() => {\n            this.fetchPreferences();\n        });\n    }\n\n    /**\n     * Update preferences after a certain time. The purpose is to store the updated data, it won't be reflected in the view.\n     */\n    protected updatePreferencesAfterDelay(): void {\n        // Cancel pending updates.\n        clearTimeout(this.updateTimeout);\n\n        this.updateTimeout = window.setTimeout(() => {\n            this.updateTimeout = undefined;\n            this.updatePreferences();\n        }, 5000);\n    }\n\n    /**\n     * Save the contactable privacy setting..\n     *\n     * @param value The value to set.\n     */\n    async saveContactablePrivacy(value?: number | boolean): Promise<void> {\n        if (this.contactablePrivacy == this.previousContactableValue) {\n            // Value hasn't changed from previous, it probably means that we just fetched the value from the server.\n            return;\n        }\n\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n\n        if (!this.advancedContactable) {\n            // Convert from boolean to number.\n            value = value ? 1 : 0;\n        }\n\n        try {\n            await CoreUser.updateUserPreference('message_blocknoncontacts', String(value));\n            // Update the preferences since they were modified.\n            this.updatePreferencesAfterDelay();\n            this.previousContactableValue = this.contactablePrivacy;\n        } catch (message) {\n            // Show error and revert change.\n            CoreDomUtils.showErrorModal(message);\n            this.contactablePrivacy = this.previousContactableValue;\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n    /**\n     * Change the value of a certain preference. Versions 3.6 onwards.\n     *\n     * @param notification Notification object.\n     * @param processor Notification processor.\n     */\n    async changePreference(\n        notification: AddonMessagesMessagePreferencesNotificationFormatted,\n        processor: AddonMessagesMessagePreferencesNotificationProcessor,\n    ): Promise<void> {\n        // Update both states at the same time.\n        let value = notification.processors\n            .filter((processor) => processor.enabled)\n            .map((processor) => processor.name)\n            .join(',');\n\n        if (value == '') {\n            value = 'none';\n        }\n\n        notification.updating = true;\n\n        const promises: Promise<void>[] = [];\n        if (this.loggedInOffLegacyMode) {\n            promises.push(CoreUser.updateUserPreference(notification.preferencekey + '_loggedin', value));\n            promises.push(CoreUser.updateUserPreference(notification.preferencekey + '_loggedoff', value));\n        }  else {\n            promises.push(CoreUser.updateUserPreference(notification.preferencekey + '_enabled', value));\n        }\n\n        try {\n            await Promise.all(promises);\n            // Update the preferences since they were modified.\n            this.updatePreferencesAfterDelay();\n        } catch (error) {\n            // Show error and revert change.\n            CoreDomUtils.showErrorModal(error);\n            processor.enabled = !processor.enabled;\n        } finally {\n            notification.updating = false;\n        }\n    }\n\n    /**\n     * Change the value of a certain preference. Only on version 3.5.\n     *\n     * @param notification Notification object.\n     * @param processor Notification processor.\n     * @param state State name, ['loggedin', 'loggedoff'].\n     */\n    async changePreferenceLegacy(\n        notification: AddonMessagesMessagePreferencesNotificationFormatted,\n        processor: AddonMessagesMessagePreferencesNotificationProcessor,\n        state: 'loggedin' | 'loggedoff',\n    ): Promise<void> {\n        // Update only the specified state.\n        const processorState: AddonNotificationsPreferencesNotificationProcessorState = processor[state];\n        const preferenceName = notification.preferencekey + '_' + processorState.name;\n\n        const value = notification.processors\n            .filter((processor) => processor[state].checked)\n            .map((processor) => processor.name)\n            .join(',');\n\n        notification['updating'+state] = true;\n        try {\n            await CoreUser.updateUserPreference(preferenceName, value);\n            // Update the preferences since they were modified.\n            this.updatePreferencesAfterDelay();\n        } catch (error) {\n            // Show error and revert change.\n            CoreDomUtils.showErrorModal(error);\n            processorState.checked = !processorState.checked;\n        } finally {\n            notification['updating'+state] = false;\n        }\n    }\n\n    /**\n     * Refresh the list of preferences.\n     *\n     * @param refresher Refresher.\n     */\n    refreshPreferences(refresher?: IonRefresher): void {\n        AddonMessages.invalidateMessagePreferences().finally(() => {\n            this.fetchPreferences().finally(() => {\n                refresher?.complete();\n            });\n        });\n    }\n\n    /**\n     * Send on Enter toggle has changed.\n     */\n    sendOnEnterChanged(): void {\n        // Save the value.\n        CoreConfig.set(CoreConstants.SETTINGS_SEND_ON_ENTER, this.sendOnEnter ? 1 : 0);\n\n        // Notify the app.\n        CoreEvents.trigger(\n            CoreEvents.SEND_ON_ENTER_CHANGED,\n            { sendOnEnter: !!this.sendOnEnter },\n            CoreSites.getCurrentSiteId(),\n        );\n    }\n\n    /**\n     * @inheritdoc\n     */\n    ngOnDestroy(): void {\n        // If there is a pending action to update preferences, execute it right now.\n        if (this.updateTimeout) {\n            clearTimeout(this.updateTimeout);\n            this.updatePreferences();\n        }\n    }\n\n}\n\n/**\n * Message preferences notification with some caclulated data.\n */\ntype AddonMessagesMessagePreferencesNotificationFormatted = AddonMessagesMessagePreferencesNotification & {\n    updating?: boolean; // Calculated in the app. Whether the notification is being updated.\n    updatingloggedin?: boolean; // Calculated in the app. Whether the notification is being updated.\n    updatingloggedoff?: boolean; // Calculated in the app. Whether the notification is being updated.\n};\n"],"sourceRoot":"webpack:///"}